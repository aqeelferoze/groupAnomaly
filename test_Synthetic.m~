clear; clc;
addpath(genpath('~/Documents/MATLAB/groupAnomaly'));
global verbose;
verbose = 1;

load ('syn10.mat');


%% 
import GLAD2.*
var_para = GLAD2.train(data,hyper_para);
%%
[~, G_idx] = max(var_para.lambda);
[~, R_idx] = max(var_para.mu);
M = 10; K = 2; N = 1000;
theta_emp = zeros(K,M);
for n = 1:N
    thetaG_idx(n) 
    
    


scores = GLAD2.score_var(data.X, data.Y , hyper_para, var_para);
 

%%
import GLAD_Sample.*;

nC = 100;
nM = 100;
[Pi,Gp,Rp] = GLAD_Sample.samplingGLAD(data.X,data.Y,hyper_para.B,hyper_para.theta',hyper_para.beta,hyper_para.alpha,nC,nM);





